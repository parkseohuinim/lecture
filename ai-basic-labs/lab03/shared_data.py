"""
공통 데이터 및 유틸리티
- 교육용 샘플 텍스트
- PDF 내용이 짧을 때 사용하는 기본 텍스트
"""

# 교육용 샘플 텍스트 (PDF 없이도 실습 가능)
SAMPLE_TEXT = """
# 인공지능과 머신러닝 완벽 가이드

## 1장: 인공지능의 기초

인공지능(AI, Artificial Intelligence)은 인간의 학습, 추론, 지각 능력을 컴퓨터로 구현하는 기술입니다. 
1956년 다트머스 회의에서 존 매카시가 처음으로 "인공지능"이라는 용어를 사용했습니다.

### 인공지능의 역사
- 1950년대: 앨런 튜링의 튜링 테스트 제안
- 1960년대: 전문가 시스템의 등장
- 1980년대: 신경망 연구의 부활
- 2010년대: 딥러닝 혁명과 GPU 컴퓨팅
- 2020년대: 대규모 언어모델(LLM)과 생성형 AI의 시대

### 인공지능의 분류
1. **약한 AI (Narrow AI)**: 특정 작업에 특화된 AI. 예: 체스 프로그램, 음성 인식
2. **강한 AI (General AI)**: 인간 수준의 범용 지능. 아직 이론적 단계
3. **초인공지능 (Super AI)**: 인간을 초월하는 지능. 미래 가능성

## 2장: 머신러닝 핵심 개념

머신러닝(ML, Machine Learning)은 데이터에서 패턴을 학습하여 예측하는 AI의 하위 분야입니다.
명시적인 프로그래밍 없이 컴퓨터가 스스로 학습하는 것이 핵심입니다.

### 머신러닝의 유형

#### 지도 학습 (Supervised Learning)
레이블이 있는 데이터로 학습합니다. 입력과 정답 쌍을 통해 모델을 훈련합니다.
- **분류(Classification)**: 이메일 스팸 탐지, 질병 진단, 이미지 분류
- **회귀(Regression)**: 주택 가격 예측, 매출 예측, 기온 예측
- 주요 알고리즘: 선형 회귀, 로지스틱 회귀, 결정 트리, 랜덤 포레스트, SVM, XGBoost

#### 비지도 학습 (Unsupervised Learning)  
레이블이 없는 데이터에서 패턴을 발견합니다.
- **클러스터링(Clustering)**: 고객 세분화, 문서 그룹화
- **차원 축소(Dimensionality Reduction)**: 데이터 시각화, 특징 압축
- 주요 알고리즘: K-Means, DBSCAN, PCA, t-SNE, Autoencoder

#### 강화 학습 (Reinforcement Learning)
환경과 상호작용하며 보상을 최대화하는 방향으로 학습합니다.
- 게임 AI: 알파고, OpenAI Five
- 로봇 제어: 로봇 걷기, 드론 비행
- 추천 시스템: 개인화된 콘텐츠 추천
- 주요 알고리즘: Q-Learning, DQN, PPO, A3C

## 3장: 딥러닝과 신경망

딥러닝(Deep Learning)은 인공 신경망을 여러 층으로 쌓아 복잡한 패턴을 학습하는 기술입니다.
2012년 ImageNet 대회에서 AlexNet이 우승하며 딥러닝 시대가 본격적으로 시작되었습니다.

### 신경망의 구조
- **입력층(Input Layer)**: 데이터를 받아들이는 층
- **은닉층(Hidden Layer)**: 특징을 추출하고 변환하는 층들
- **출력층(Output Layer)**: 최종 예측을 출력하는 층
- **활성화 함수**: ReLU, Sigmoid, Tanh, Softmax

### 주요 딥러닝 아키텍처

#### CNN (Convolutional Neural Network)
이미지 처리에 특화된 신경망입니다.
- 합성곱 층으로 지역적 특징 추출
- 풀링 층으로 공간적 크기 축소
- 응용: 얼굴 인식, 자율주행, 의료 영상 분석
- 대표 모델: VGGNet, ResNet, EfficientNet

#### RNN (Recurrent Neural Network)
순차 데이터 처리에 적합한 신경망입니다.
- 이전 상태의 정보를 현재로 전달
- 장기 의존성 문제로 LSTM, GRU 등장
- 응용: 기계 번역, 음성 인식, 시계열 예측

#### Transformer
2017년 "Attention is All You Need" 논문에서 제안되었습니다.
- Self-Attention 메커니즘으로 병렬 처리 가능
- 위치 인코딩으로 순서 정보 표현
- BERT, GPT, T5 등 현대 언어모델의 기반
- 응용: 자연어 처리, 이미지 생성, 코드 생성

## 4장: 자연어 처리 (NLP)

자연어 처리(NLP, Natural Language Processing)는 컴퓨터가 인간의 언어를 이해하고 생성하는 기술입니다.

### NLP의 주요 태스크
- **텍스트 분류**: 감성 분석, 스팸 탐지, 주제 분류
- **개체명 인식(NER)**: 인명, 지명, 조직명 추출
- **기계 번역**: 영어-한국어, 다국어 번역
- **질의응답(QA)**: 문서 기반 답변 생성
- **텍스트 요약**: 문서 요약, 뉴스 요약
- **대화 시스템**: 챗봇, 가상 비서

### 대규모 언어모델 (LLM)
GPT, Claude, Gemini 등 수십억 개의 파라미터를 가진 모델들입니다.
- **사전학습(Pre-training)**: 대규모 텍스트로 언어 패턴 학습
- **미세조정(Fine-tuning)**: 특정 태스크에 맞게 추가 학습
- **프롬프트 엔지니어링**: 효과적인 입력 설계
- **RAG(Retrieval-Augmented Generation)**: 외부 지식 활용

## 5장: RAG (검색 증강 생성)

RAG는 대규모 언어모델의 한계를 보완하는 기술입니다.
외부 문서를 검색하여 LLM에게 제공함으로써 정확하고 최신의 답변을 생성합니다.

### RAG의 필요성
1. **환각(Hallucination) 방지**: 사실에 기반한 답변 생성
2. **최신 정보 반영**: 학습 컷오프 이후 정보 활용
3. **도메인 특화**: 특정 분야 문서 기반 답변
4. **비용 효율성**: 재학습 없이 지식 업데이트

### RAG 파이프라인
1. **문서 수집**: PDF, 웹페이지, 데이터베이스에서 문서 로드
2. **청킹(Chunking)**: 문서를 적절한 크기로 분할
3. **임베딩(Embedding)**: 텍스트를 벡터로 변환
4. **인덱싱**: 벡터 데이터베이스에 저장
5. **검색(Retrieval)**: 쿼리와 유사한 문서 검색
6. **생성(Generation)**: 검색된 문서 기반 답변 생성

### 검색 방법 비교
- **Sparse 검색 (BM25)**: 키워드 기반, 정확한 단어 매칭에 강함
- **Dense 검색 (Vector)**: 의미 기반, 동의어와 문맥 이해에 강함
- **Hybrid 검색**: 두 방법의 장점 결합

### 고급 RAG 기법
- **Re-ranking**: 초기 검색 결과를 다시 순위화
- **Multi-hop 검색**: 여러 단계 추론이 필요한 질문 처리
- **Query Expansion**: 쿼리 확장으로 검색 품질 향상
- **Contextual Compression**: 관련 부분만 추출하여 컨텍스트 최적화

## 6장: 컴퓨터 비전

컴퓨터 비전(Computer Vision)은 컴퓨터가 이미지와 영상을 이해하는 기술입니다.

### 주요 태스크
- **이미지 분류**: 사진 속 객체 분류
- **객체 탐지(Object Detection)**: 객체 위치와 종류 탐지
- **시맨틱 세그멘테이션**: 픽셀 단위 분류
- **포즈 추정**: 인체 관절 위치 추정
- **얼굴 인식**: 신원 확인, 감정 분석

### 응용 분야
- 자율주행: 차선 인식, 보행자 탐지
- 의료: X-ray 분석, 병변 탐지
- 제조: 불량품 검출, 품질 관리
- 보안: CCTV 분석, 이상 행동 탐지

## 7장: 생성형 AI

생성형 AI(Generative AI)는 새로운 콘텐츠를 생성하는 AI입니다.

### 생성 모델의 종류
- **GAN (Generative Adversarial Network)**: 생성자와 판별자의 경쟁
- **VAE (Variational Autoencoder)**: 잠재 공간에서 생성
- **Diffusion Model**: 노이즈 제거 과정으로 생성
- **Transformer 기반**: GPT, DALL-E, Stable Diffusion

### 응용 분야
- **텍스트 생성**: 글쓰기 보조, 코드 생성, 번역
- **이미지 생성**: 예술 작품, 제품 디자인, 광고
- **음악/오디오**: 작곡, 음성 합성
- **영상 생성**: 애니메이션, 특수효과

## 8장: AI 윤리와 책임

AI 기술의 발전과 함께 윤리적 고려가 중요해지고 있습니다.

### 주요 이슈
- **편향성(Bias)**: 학습 데이터의 편향이 결과에 반영
- **프라이버시**: 개인정보 보호와 데이터 활용의 균형
- **일자리 변화**: 자동화로 인한 직업 구조 변화
- **악용 가능성**: 딥페이크, 허위정보 생성
- **설명 가능성(Explainability)**: AI 결정의 투명성

### AI 거버넌스
- EU AI Act: 위험 기반 규제 프레임워크
- 미국 AI 행정명령: 안전하고 신뢰할 수 있는 AI
- 한국 AI 법제화: AI 기본법 추진

## 9장: AI 개발 도구와 프레임워크

### Python 라이브러리
- **NumPy**: 수치 연산의 기반
- **Pandas**: 데이터 분석과 조작
- **Scikit-learn**: 전통적 머신러닝 알고리즘
- **TensorFlow/Keras**: 구글의 딥러닝 프레임워크
- **PyTorch**: 페이스북의 딥러닝 프레임워크, 연구용 인기
- **Hugging Face Transformers**: 사전학습 모델 허브

### 벡터 데이터베이스
- **Chroma**: 경량, 로컬 개발에 적합
- **Pinecone**: 클라우드 기반, 관리형 서비스
- **Weaviate**: 오픈소스, 다양한 모듈 지원
- **Milvus**: 대규모 데이터 처리에 최적화
- **Qdrant**: 고성능 유사도 검색

### LLM 개발 도구
- **LangChain**: LLM 애플리케이션 개발 프레임워크
- **LlamaIndex**: 데이터 연결과 검색에 특화
- **OpenAI API**: GPT 모델 접근
- **Anthropic API**: Claude 모델 접근

## 10장: 실무 적용 가이드

### 프로젝트 단계
1. **문제 정의**: 비즈니스 목표와 AI 적용 범위 설정
2. **데이터 수집**: 필요한 데이터 확보 및 정제
3. **모델 선택**: 태스크에 적합한 모델 선정
4. **학습 및 평가**: 모델 훈련과 성능 측정
5. **배포**: 프로덕션 환경 적용
6. **모니터링**: 성능 추적 및 지속적 개선

### 성공 요인
- 명확한 목표 설정
- 양질의 데이터 확보
- 반복적인 실험과 개선
- 도메인 전문가와의 협업
- 윤리적 고려 사항 반영

### 흔한 실수
- 데이터 품질 무시
- 과적합(Overfitting) 문제
- 평가 지표 오선택
- 확장성 미고려
- 유지보수 계획 부재

이 가이드를 통해 인공지능과 머신러닝의 핵심 개념을 이해하고, 
실무에서 AI 프로젝트를 성공적으로 수행할 수 있기를 바랍니다.
"""

# 최소 텍스트 길이 (이보다 짧으면 SAMPLE_TEXT 사용)
MIN_TEXT_LENGTH = 2000


def get_sample_or_document_text(document_text: str = None) -> tuple:
    """
    문서 텍스트를 반환하거나, 너무 짧으면 샘플 텍스트 반환
    
    Args:
        document_text: 문서에서 추출한 텍스트
    
    Returns:
        (텍스트, 사용된 소스 타입 "document" 또는 "sample")
    """
    if document_text and len(document_text) >= MIN_TEXT_LENGTH:
        return document_text, "document"
    
    if document_text:
        print(f"[!] 문서 텍스트가 너무 짧습니다 ({len(document_text)}자 < {MIN_TEXT_LENGTH}자)")
        print("    --> 내장 샘플 텍스트로 대체합니다.")
    
    return SAMPLE_TEXT, "sample"


